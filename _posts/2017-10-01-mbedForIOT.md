---
title: "mbedでedge deviceを試してみた"
date: 2017-10-01 19:34:11
categories: mbed
tags:
---

mbedでmiklcocoaのクライアントデバイスを作ってみました。

結果的には、とりあえず動く、ものは簡単に作れましたが、RaspberryPIで作った物と同じようなスペックにしようと思うと、結構色々と考える必要がある、という感じです。

__作成中__

<!-- more -->

## 仕様
以前RaspberryPiで作ったデバイスを置き換える、ということをターゲットとしました。そのため、以下のようなスペックが必要となります。

1. RTCによりデバイス自身によってデータのタイムスタンプを押す
1. 後処理の簡単のためデータ構造（JSON）を階層構造にする

## 使うmbedデバイス
今回はEthernetが標準装備である事が必須となります。また、仕事も多いので比較的メモリの大きい物が必要となる可能性、販売から時間が経っていて実例の多い物、という条件から [FRDM-K64F](https://os.mbed.com/platforms/FRDM-K64F/)を選びました。

チャレンジするならNUCLEO-F207ZGでやってみたい所ですが、まずは動かす事を優先にしました。

## RTCの用意
あまり意識していませんでしたがFRDM-K64FにはRTCが用意されています。しかし、バックアップが無いので、電源を入れるたびにリセットされてしまいます。

そのため、RTC用の電源端子へ3.3Vを供給しているラインを切って、ダイオードを入れ、その先（CPU側）に電気二重層コンデンサを入れるようにしました。

![RTC電源回路改造](/image/20171001_01.png "Circuit Diagram")
